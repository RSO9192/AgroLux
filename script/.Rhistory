results_cw %>%
ggplot(aes(Year1,Rain)) +
geom_bar(aes(fill=cycle), stat="identity", position = position_dodge())+
facet_rep_grid(Station~date_f)+
geom_smooth()+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")
results_cw %>%
ggplot(aes(Year1,Rain)) +
geom_bar(aes(fill=cycle), stat="identity", position = position_dodge())+
facet_rep_grid(Station~date_f)+
geom_smooth(aes(color=cycle, shape=RCP))+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")
results_cw %>%
ggplot(aes(Year1,Rain)) +
geom_bar(aes(fill=cycle), stat="identity", position = position_dodge())+
facet_rep_grid(Station~date_f)+
geom_smooth(aes(color=cycle, shape=RCP), se=FALSE, method = "lm")+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")
results_cw %>%
ggplot(aes(Year1,Rain)) +
geom_bar(aes(fill=cycle), stat="identity", position = position_dodge())+
facet_rep_grid(Station~date_f)+
geom_smooth(aes(color=cycle, linetype=RCP), se=FALSE, method = "lm")+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")
results_cw %>%
ggplot(aes(Year1,Rain)) +
geom_bar(aes(fill=cycle), stat="identity", position = position_dodge())+
facet_rep_grid(Station~date_f)+
geom_smooth(aes(color=cycle), se=FALSE, method = "lm")+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")
results_cw %>%
ggplot(aes(Year1,Rain)) +
geom_bar(aes(fill=cycle), stat="identity", position = position_dodge())+
facet_rep_grid(Station~date_f)+
geom_smooth(aes(color=cycle), se=FALSE, method = "lm")+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Rain (mm)")
ggsave("combined_rain.png", width = 8, height = 12, units = "in")
results_cw %>%
ggplot(aes(Year1,Rain)) +
geom_bar(aes(fill=cycle), stat="identity", position = position_dodge())+
facet_rep_grid(Station~date_f)+
geom_smooth(aes(color=cycle), se=FALSE, method = "lm")+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
scale_fill_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Rain (mm)")
results_cw %>%
ggplot(aes(Year1,Rain)) +
geom_bar(aes(fill=cycle), stat="identity", position = position_dodge())+
facet_rep_grid(Station~date_f)+
geom_smooth(aes(color=cycle), se=FALSE, method = "lm")+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
scale_fill_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Rain (mm)")
ggsave("combined_rain.png", width = 8, height = 12, units = "in")
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")
results_cw$stress <- results_cw$StoStr+results_cw$ExpStr
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")
ggsave("combined_rain_stress.png", width = 8, height = 12, units = "in")
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")+
xlim(c(0,140))
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")+
xlim(c(0,140))
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")+
xlim(0,140)
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Crop cycle")+
ylim(0,140)
library(tidyverse)
library(readxl)
library(glue)
library(gtools)
library(xlsx)
library(mgcv)
library(gridExtra)
library(RColorBrewer)
library(lemon)
source("~/theme_publication.R")
# loading the results file
#setwd(dirname(rstudioapi::getSourceEditorContext()$path))
header <- read.table("../Simulations/1_RCP45_rainfed_15thJuly_clayloam_shortPRMseason.OUT", skip = 2, nrows = 1) # all header are the same, so we can just use one header for all files
header <- as.vector(t(header))
files <- list.files("../Simulations/") # getting files name
list_all_output <- lapply(files, function(x) {read.table(glue("../Simulations/{x}"), skip = 4)}) # reading all dataframes into a list
names(list_all_output) <- files
str_match(names(list_all_output)[1], "(\\D+)_(\\D+PRM)") [,3] %>%
str_remove(., "PRM")
# Here we are changing colnames, and adding variable names
for (df in 1:length(list_all_output)) {
colnames(list_all_output[[df]]) <- header
list_all_output[[df]]$Station <- as.character(str_match(names(list_all_output[df]), "\\d+"))
list_all_output[[df]]$RCP <- as.character(str_match(names(list_all_output[df]), ".{3}\\d+"))
list_all_output[[df]]$cycle <- as.character(str_match(names(list_all_output[df]),"(\\D+)_(\\D+PRM)") [,3] %>%
str_remove(., "PRM"))
list_all_output[[df]]$date <- str_match(names(list_all_output[df]), "_(\\d+.*)_") [,2] %>%
str_remove(., "_clayloam") %>%
str_remove(., "_")
}
results_cw <- do.call(rbind, list_all_output)
rownames(results_cw) <- NULL
Station2=paste0("Location ", results_cw$Station)
results_cw$Station=Station2
results_cw$date_f = factor(results_cw$date, levels=c('15thJune','1stJuly','15thJuly','1stAugust'))
results_cw %>%
ggplot(aes(Year1,Yield)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
ylab("Yield (ton/ha)")+
xlab("Year")
ggsave("combined_yield.svg", width = 8, height = 12, units = "in")
ggsave("combined_yield.svg", width = 8, height = 12, units = "in")
results_cw %>%
ggplot(aes(Year1,WPet)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y=expression(paste("CWP ", "(Kg/",m^3,")")))
ggsave("combined_yield.svg", width = 8, height = 12, units = "in")
results_cw %>%
ggplot(aes(Year1,WPet)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y=expression(paste("CWP ", "(Kg/",m^3,")")))
ggsave("combined_WUE_wheat.svg", width = 8, height = 12, units = "in")
ggsave("combined_WUE_wheat.svg", width = 8, height = 12, units = "in")
results_cw$stress <- results_cw$StoStr+results_cw$ExpStr
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Stress")+
ylim(0,140)
facet_rep_grid(Station~date_f, scale="free+
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f, scale="free")+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Stress")+
ylim(0,140)
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f, scale="free")+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Stress")
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Stress")
results_cw %>%
ggplot(aes(Year1,Rain)) +
geom_bar(aes(fill=cycle), stat="identity", position = position_dodge())+
facet_rep_grid(Station~date_f)+
geom_smooth(aes(color=cycle), se=FALSE, method = "lm")+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
scale_fill_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Rain (mm)")
ggsave("combined_rain.svg", width = 8, height = 12, units = "in")
results_cw %>%
ggplot(aes(Year1,Rain)) +
geom_bar(aes(fill=cycle), stat="identity", position = position_dodge())+
facet_rep_grid(Station~date_f)+
geom_smooth(aes(color=cycle), se=FALSE, method = "lm")+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
scale_fill_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Rain (mm)")
View(results_cw)
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Stress")
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
# geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Stress")
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
ylim(0:130)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Stress")
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
ylim(0,130)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Stress")
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
ylim(0,200)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Stress")
results_cw %>%
ggplot(aes(Year1,stress)) +
geom_point(aes(color=cycle, shape=RCP), size=1, alpha=0.3)+
geom_smooth(aes(color=cycle, linetype=RCP), size=1, method = "lm", se = FALSE)+
facet_rep_grid(Station~date_f)+
ylim(0,150)+
coord_capped_cart(bottom='both', left='both') +
theme_Publication()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),text = element_text(size=12))+
theme(panel.border=element_blank(), axis.line=element_line())+
scale_color_manual(values = c("dodgerblue1","Red", "darkgreen"))+
labs(x="Year", y="Stress")
ggsave("combined_rain_stress.svg", width = 8, height = 12, units = "in")
install.packages('mlr')
install.packages("torch")
library(mlbench)
data("HouseVotes84")
votesTask <- makeClassifTask(data = HouseVotes84, target = 'Class')
library(mlr) # similar to Python's sci-kit learn (sklearn)
library(tidyverse)
spamTask <- makeClassifTask(data = spam, target = 'type')
votesTask <- makeClassifTask(data = HouseVotes84, target = 'Class')
nbayesLearner <- makeLearner('classif.naiveBayes')
nbayesLearnerTrained <- train(nbayesLearner, votesTask)
p <- predict(nbayesLearnerTrained, newdata = HouseVotes84)
calculateROCMeasures(p)
kfold_cv <- makeResampleDesc(method = 'RepCV',
folds = 20,
reps = 10,
stratify = T)
nbayesCV <- resample(learner = nbayesLearner,
task = votesTask,
resampling = kfold_cv,
measures = list(acc, mmce, fpr, tpr, ppv, f1))
nbayesCV$aggr
?makeLearner
library(kernlab)
data(spam)
library(tidyverse)
library(readxl)
source("~/theme_publication.R")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
fig2b <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 4, skip = 7, n_max = 49) %>%
group_by(Treatments, `Leaf*`) %>%
summarise(Mean=mean(`Mean**`))
fig2b %>%
group_by(Treatments) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean), ) %>%
mutate(se=se/1000, Mean=Mean/1000) %>%
mutate(Treatments = fct_relevel(Treatments,
"WT + WT(GFP)", "LUX + WT(GFP)", "WT + LUX(GFP)")) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="darkgreen", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig2b, aes(Treatments, Mean/1000), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("GFP (RFUx1000)")+
theme(axis.text.x = element_text(angle = 45, hjust=1))
ggsave("../results/fig2b.pdf", width = 7, height = 12, units = "cm")
fig2c <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 5, skip = 7, n_max = 49) %>%
group_by(Treatments, `Leaf*`) %>%
summarise(Mean=mean(`Mean – Background**`, na.rm = TRUE))
fig2c %>%
group_by(Treatments) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
mutate(se=se, Mean=Mean) %>%
mutate(Treatments = fct_relevel(Treatments,
"WT + WT(GFP)", "LUX + WT(GFP)", "WT + LUX(GFP)")) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig2c, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
theme(axis.text.x = element_text(angle = 45, hjust=1))
ggsave("../results/fig2c.pdf", width = 7, height = 12, units = "cm")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
fig2b <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 4, skip = 7, n_max = 49) %>%
group_by(Treatments, `Leaf*`) %>%
summarise(Mean=mean(`Mean**`))
fig2b %>%
group_by(Treatments) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean), ) %>%
mutate(se=se/1000, Mean=Mean/1000) %>%
mutate(Treatments = fct_relevel(Treatments,
"WT + WT(GFP)", "LUX + WT(GFP)", "WT + LUX(GFP)")) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="darkgreen", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig2b, aes(Treatments, Mean/1000), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("GFP (RFUx1000)")+
theme(axis.text.x = element_text(angle = 45, hjust=1))
ggsave("../results/fig2b.pdf", width = 7, height = 12, units = "cm")
fig2c <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 5, skip = 7, n_max = 49) %>%
group_by(Treatments, `Leaf*`) %>%
summarise(Mean=mean(`Mean – Background**`, na.rm = TRUE))
fig2c %>%
group_by(Treatments) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
mutate(se=se, Mean=Mean) %>%
mutate(Treatments = fct_relevel(Treatments,
"WT + WT(GFP)", "LUX + WT(GFP)", "WT + LUX(GFP)")) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig2c, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
theme(axis.text.x = element_text(angle = 45, hjust=1))
ggsave("../results/fig2c.pdf", width = 7, height = 12, units = "cm")
fig4b <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 8, skip = 7, n_max = 37) %>%
select(-Mean) %>%
rename(Mean=`Mean – Background**`)
fig4b %>%
group_by(Treatments, dpi) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig4b, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
facet_wrap(~dpi) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
ggsave("../results/fig4b.pdf", width = 10, height = 12, units = "cm")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
