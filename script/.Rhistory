ggplot(map.table, aes(Subpopulation,Ca))+
geom_boxplot()+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("Ca (mg/Kg)")
ggsave("../results/plots/Ca_sub.svg", width = 7, height = 7, units = "cm")
ggplot(map.table, aes(Subpopulation,Flowering_time))+
geom_boxplot()+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("FT (days)")
ggplot(map.table, aes(Subpopulation,Flowering_time))+
geom_boxplot()+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("FT (days)")
ggplot(map.table, aes(Subpopulation,Flowering_time))+
geom_boxplot()+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("FT (days)")
ggsave("../results/plots/FT_sub.svg", width = 7, height = 7, units = "cm")
ggplot(map.table, aes(Subpopulation,Flowering_time))+
geom_boxplot(coef=6)+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("FT (days)")
ggsave("../results/plots/FT_sub.svg", width = 7, height = 7, units = "cm")
ggplot(map.table, aes(Subpopulation,Ca))+
geom_boxplot(coef=6)+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("Ca (mg/Kg)")
ggsave("../results/plots/Ca_sub.svg", width = 7, height = 7, units = "cm")
map.table2 <- map.table %>%
dplyr::rename(FT=Flowering_time)
View(map.table2)
mat <- as.matrix(map.table2[,11:24])
res2 <- rcorr(mat) # applying functions for correlation
corrplot(res2$r, type="upper",
p.mat = res2$P, sig.level = 0.01, insig = "blank",tl.cex=2, tl.col = "black") # plotting function
corrplot(res2$r, type="upper",
p.mat = res2$P, sig.level = 0.01, insig = "blank",tl.cex=2, tl.col = "black") # plotting function
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reshape2)
library(permute)
library(lattice)
library(scales)
library(grid)
library(phyloseq)
library(ape)
library(metagMisc)
library(png)
library(data.table)
library(RColorBrewer)
library(ggsci)
library(DECIPHER)
library(phangorn)
library(ShortRead)
library(dada2)
library(ampvis2)
library(devtools)
library(stringr)
library(glue)
library(gridExtra)
#library(phylogeo)
library(ggvegan)
library(microbiomeSeq)
library(metacoder)
library(vegan)
library(corrplot)
library(Hmisc)
library(lme4)
library(nlme)
library(car)
source('~/theme_publication.R')
library(tidyverse)
library(reshape2)
library(permute)
library(lattice)
library(scales)
library(grid)
library(phyloseq)
library(ape)
library(metagMisc)
library(png)
library(data.table)
library(RColorBrewer)
library(ggsci)
library(DECIPHER)
library(phangorn)
library(ShortRead)
library(dada2)
library(ampvis2)
library(devtools)
library(stringr)
library(glue)
library(gridExtra)
#library(phylogeo)
library(ggvegan)
library(microbiomeSeq)
library(metacoder)
library(vegan)
library(corrplot)
library(Hmisc)
library(lme4)
library(nlme)
library(car)
source('~/theme_publication.R')
# transforming macro minerals into mg/kg.
map.table <- read.csv("../results/tables/map_table.csv", sep = "\t" ) %>%
filter(!str_detect(Sample_ID, "s")) %>%
mutate_at(13:16, function(x) x*10000)
map.table2 <- map.table %>%
dplyr::rename(FT=Flowering_time)
mat <- as.matrix(map.table2[,11:24])
res2 <- rcorr(mat) # applying functions for correlation
corrplot(res2$r, type="upper",
p.mat = res2$P, sig.level = 0.01, insig = "blank",tl.cex=2, tl.col = "black") # plotting function
corrplot(res2$r, type="upper",
p.mat = res2$P, sig.level = 0.01, insig = "blank",tl.cex=1, tl.col = "black") # plotting function
corrplot(res2$r, type="upper",
p.mat = res2$P, sig.level = 0.01, insig = "blank",tl.cex=1.5, tl.col = "black") # plotting function
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reshape2)
library(permute)
library(lattice)
library(scales)
library(grid)
library(phyloseq)
library(ape)
library(metagMisc)
library(png)
library(data.table)
library(RColorBrewer)
library(ggsci)
library(DECIPHER)
library(phangorn)
library(ShortRead)
library(dada2)
library(ampvis2)
library(devtools)
library(stringr)
library(glue)
library(gridExtra)
#library(phylogeo)
library(ggvegan)
library(microbiomeSeq)
library(metacoder)
library(vegan)
library(corrplot)
library(Hmisc)
library(lme4)
library(nlme)
library(car)
source('~/theme_publication.R')
library(jtools)
ps.sv<- readRDS("../results/tables/ps_sv.rds")
# extracting otu table
otu_v <- as.data.frame(otu_table(ps.sv))
# creating column for SV number
otu_v$SV <- rownames(otu_v)
rownames(otu_v) <- NULL
# reordering
otu_v <- otu_v %>%
select(SV, everything())
# making col names as Sv numbers
rownames(otu_v) <- otu_v$SV
otu_v <- otu_v %>%
select(-SV)
# traspose for format required by vegan
otu_v_sv <- as.data.frame(t(otu_v))
sh.index <- vegan::diversity(otu_v_sv, "shannon")
# transofrming K,Ca,P,Mg in mg/Kg by multiplying by 10,000
map.table <- read.csv("../results/tables/map_table.csv") %>%
filter(Sample_ID!="wheat") %>%
mutate_at(12:15, function(x) x*10000)
ggplot(map.table, aes(Subpopulation,Ca))+
geom_boxplot(coef=6)+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("Ca (mg/Kg)")
ggsave("../results/plots/Ca_subpop.svg", width = 7, height = 7, units = "cm")
ggplot(map.table, aes(Subpopulation,Flowering_time))+
geom_boxplot(coef=6)+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("FT (days)")
ggsave("../results/plots/FT_subpop.svg", width = 7, height = 7, units = "cm")
map.table2 <- map.table %>%
dplyr::rename(FT=Flowering_time)
mat <- as.matrix(map.table2[,10:23])
res2 <- rcorr(mat) # applying functions for correlation
corrplot(res2$r, type="upper",
p.mat = res2$P, sig.level = 0.01, insig = "blank",tl.cex=1.5, tl.col = "black")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reshape2)
library(permute)
library(lattice)
library(scales)
library(grid)
library(phyloseq)
library(ape)
library(metagMisc)
library(png)
library(data.table)
library(RColorBrewer)
library(ggsci)
library(DECIPHER)
library(phangorn)
library(ShortRead)
library(dada2)
library(ampvis2)
library(devtools)
library(stringr)
library(glue)
library(gridExtra)
#library(phylogeo)
library(ggvegan)
library(microbiomeSeq)
library(metacoder)
library(vegan)
library(corrplot)
library(Hmisc)
library(lme4)
library(nlme)
library(car)
source('~/theme_publication.R')
ps.sv<- readRDS("../results/tables/ps_sv.rds")
map.table <- read.csv("../results/tables/map.table.csv", sep = "\t" ) %>%
mutate_at(12:15, function(x) x*10000) %>%
filter(Sample_ID!="G25908.2")
ggplot(map.table, aes(Subpopulation,Mg))+
geom_boxplot(coef=6)+
geom_point(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("Mg (mg/Kg)")
ggplot(map.table, aes(Subpopulation,Ca))+
geom_boxplot(coef=6)+
geom_point(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("Ca (mg/Kg)")
ggplot(map.table, aes(Subpopulation,Flowering_time))+
geom_boxplot(coef=6)+
geom_point(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("FT (days)")
ggplot(map.table, aes(Subpopulation,Flowering_time))+
geom_boxplot(coef=6)+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("FT (days)")
ggplot(map.table, aes(Subpopulation,Ca))+
geom_boxplot(coef=6)+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("Ca (mg/Kg)")
ggplot(map.table, aes(Subpopulation,Ca))+
geom_boxplot(coef=6)+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("Ca (mg/Kg)")
ggsave("../results/plots/Ca_sub.svg", width = 7, height = 7, units = "cm")
ggplot(map.table, aes(Subpopulation,Flowering_time))+
geom_boxplot(coef=6)+
geom_jitter(size=3, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("FT (days)")
ggsave("../results/plots/FT_sub.svg", width = 7, height = 7, units = "cm")
map.table2 <- map.table %>%
rename(FT=Flowering_time)
map.table2 <- map.table %>%
dply::rename(FT=Flowering_time)
map.table2 <- map.table %>%
dplyr::rename(FT=Flowering_time)
mat <- as.matrix(map.table2[,10:23])
res2 <- rcorr(mat) # applying functions for correlation
corrplot(res2$r, type="upper",
p.mat = res2$P, sig.level = 0.05, insig = "blank",tl.cex=2, tl.col = "black") # plotting function
corrplot(res2$r, type="upper",
p.mat = res2$P, sig.level = 0.05, insig = "blank",tl.cex=1.5, tl.col = "black") # plotting function
corrplot(res2$r, type="upper",
p.mat = res2$P, sig.level = 0.05, insig = "blank",tl.cex=1.5, tl.col = "black")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reshape2)
library(permute)
library(lattice)
library(scales)
library(grid)
library(phyloseq)
library(ape)
library(metagMisc)
library(png)
library(data.table)
library(RColorBrewer)
library(ggsci)
library(DECIPHER)
library(phangorn)
library(ShortRead)
library(dada2)
library(ampvis2)
library(devtools)
library(stringr)
library(glue)
library(gridExtra)
#library(phylogeo)
library(ggvegan)
library(microbiomeSeq)
library(metacoder)
library(vegan)
library(corrplot)
library(Hmisc)
library(lme4)
library(nlme)
library(car)
source('~/theme_publication.R')
library(jtools)
ps.sv<- readRDS("../results/tables/ps_sv.rds")
# extracting otu table
otu_v <- as.data.frame(otu_table(ps.sv))
# creating column for SV number
otu_v$SV <- rownames(otu_v)
rownames(otu_v) <- NULL
# reordering
otu_v <- otu_v %>%
select(SV, everything())
# making col names as Sv numbers
rownames(otu_v) <- otu_v$SV
otu_v <- otu_v %>%
select(-SV)
# traspose for format required by vegan
otu_v_sv <- as.data.frame(t(otu_v))
sh.index <- vegan::diversity(otu_v_sv, "shannon")
# transofrming K,Ca,P,Mg in mg/Kg by multiplying by 10,000
map.table <- read.csv("../results/tables/map_table.csv") %>%
filter(Sample_ID!="wheat") %>%
mutate_at(12:15, function(x) x*10000)
ggplot(map.table, aes(Subpopulation,Ca))+
geom_boxplot(coef=6)+
geom_jitter(size=1, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("Ca (mg/Kg)")
ggsave("../results/plots/Ca_subpop.svg", width = 7, height = 7, units = "cm")
ggplot(map.table, aes(Subpopulation,Flowering_time))+
geom_boxplot(coef=6)+
geom_jitter(size=1, alpha=0.6)+
theme_Publication(base_size = 10)+
ylab("FT (days)")
ggsave("../results/plots/FT_subpop.svg", width = 7, height = 7, units = "cm")
fig4b <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 8, skip = 7, n_max = 49)
library(tidyverse)
library(readxl)
source("~/theme_publication.R")
fig4b <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 8, skip = 7, n_max = 49)
getwd()
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
fig4b <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 8, skip = 7, n_max = 49)
View(fig4b)
fig4b <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 8, skip = 7, n_max = 47)
View(fig4b)
fig4b <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 8, skip = 7, n_max = 37)
View(fig4b)
fig4b <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 8, skip = 7, n_max = 37) %>%
rename(Mean=`Mean – Background**`)
View(fig4b)
fig4b <- read_excel("../data/supp_tables_dataset_AgroLux_paper_v2.xlsx", sheet = 8, skip = 7, n_max = 37) %>%
select(-Mean) %>%
rename(Mean=`Mean – Background**`)
fig4b %>%
group_by(Treatments, dpi) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig4b, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
theme(axis.text.x = element_text(angle = 45, hjust=1))
fig4b %>%
group_by(Treatments, dpi) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig4b, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
facet_wrap(~dpi) %>%
theme(axis.text.x = element_text(angle = 45, hjust=1))
fig4b %>%
group_by(Treatments, dpi) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig4b, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
facet_wrap(~dpi) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
fig4b %>%
group_by(Treatments, dpi) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
mutate(Treatments = fct_relevel(Treatments,
"Cf4", "Avr4", "Cf4+Avr4")) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig4b, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
facet_wrap(~dpi) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
fig4b %>%
group_by(Treatments, dpi) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
mutate(Treatments = fct_relevel(Treatments,
"Cf4", "Avr4", "Cf4+Avr4")) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig4b, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
facet_wrap(~dpi) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
fig4b %>%
group_by(Treatments, dpi) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
mutate(Treatments = fct_relevel(Treatments,
"Cf4", "Avr4", "Cf4+Avr4")) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig4b, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
facet_wrap(~dpi) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
fig4b %>%
group_by(Treatments, dpi) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig4b, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
facet_wrap(~dpi) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
?t.test
fig4b %>%
filter(Treatments==`Cf4+Avr4`)
fig4b %>%
filter(Treatments=="Cf4+Avr4")
c_2dpi <- fig4b %>%
filter(Treatments=="Cf4+Avr4", dpi==2)
View(c_2dpi)
c_2dpi <- fig4b %>%
filter(Treatments=="Cf4+Avr4", dpi==2) %>%
select(Mean)
View(c_2dpi)
c_2dpi <- fig4b %>%
filter(Treatments=="Cf4+Avr4", dpi==2) %>%
select(Mean) %>%
mutate(Mean=as.vector(Mean))
View(c_2dpi)
class(c_2dpi)
c_2dpi <- fig4b %>%
filter(Treatments=="Cf4+Avr4", dpi==2) %>%
select(Mean)
t1_2dpi <-
t1_2dpi <-  fig4b %>%
filter(Treatments=="Cf4+Avr4", dpi==2) %>%
select(Mean)
t1_2dpi <-  fig4b %>%
filter(Treatments=="Avr4", dpi==2) %>%
select(Mean)
View(t1_2dpi)
t.test(as.vector(c_2dpi), as.vector(t1_2dpi))
t2_2dpi <-  fig4b %>%
filter(Treatments=="Cf4", dpi==2) %>%
select(Mean)
t.test(as.vector(c_2dpi), as.vector(t2_2dpi))
c_5dpi <- fig4b %>%
filter(Treatments=="Cf4+Avr4", dpi==5) %>%
select(Mean)
t1_5dpi <-  fig4b %>%
filter(Treatments=="Avr4", dpi==5) %>%
select(Mean)
t2_5dpi <-  fig4b %>%
filter(Treatments=="Cf4", dpi==5) %>%
select(Mean)
t.test(as.vector(c_5dpi), as.vector(t1_5dpi))
t.test(as.vector(c_5dpi), as.vector(t2_5dpi))
fig4b %>%
group_by(Treatments, dpi) %>%
summarise(N=n(),  sd=sd(Mean), se=sd/sqrt(N), Mean=mean(Mean)) %>%
ggplot(aes(Treatments, Mean)) +
geom_bar(stat="identity", width = 0.6, color="black", fill="red", alpha=0.5)+
geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se),width=0.5)+
geom_jitter(data=fig4b, aes(Treatments, Mean), size=3, alpha=0.6, width = 0.1)+
theme_Publication(base_size = 12)+
ylab("Luminescence (RLU)")+
facet_wrap(~dpi) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
ggsave("../results/fig4b.svg", width = 7, height = 12, units = "cm")
ggsave("../results/fig4b.svg", width = 10, height = 12, units = "cm")
